<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS re:Invent 2025 è¡Œç¨‹è¡¨</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        /* --- åŸºç¤æ¨£å¼ --- */
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        h1 {
            color: #232f3e;
            border-bottom: 3px solid #ff9900; /* AWS Orange */
            padding-bottom: 10px;
            margin-top: 0;
        }

        /* --- æª”æ¡ˆä¸Šå‚³å€ --- */
        .upload-box {
            background: #eef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px dashed #99c;
            text-align: center;
        }

        /* --- è¡¨æ ¼æ¨£å¼ --- */
        table {
            width: 1000px; /* å›ºå®šå¯¬åº¦æˆ– 100% */
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #232f3e; /* AWS Dark Blue */
            color: white;
            position: sticky;
            top: 0;
        }

        /* --- é—œéµä¿®æ”¹ï¼šæ—¥æœŸæ¨™é¡Œåˆ—æ¨£å¼ --- */
        tr.date-header {
            background-color: #e3f2fd !important; /* æ·ºè—è‰²åº• */
            color: #0d47a1; /* æ·±è—è‰²å­— */
            font-weight: bold;
            font-size: 1.1em;
            border-top: 2px solid #90caf9;
        }
        
        tr.date-header td {
            padding-top: 15px;
            padding-bottom: 15px;
        }

        /* å…§å®¹è¡Œæ¨£å¼ */
        tr.session-row:hover {
            background-color: #f5f5f5;
        }

        /* æ¬„ä½å¯¬åº¦èª¿æ•´ */
        .col-time { width: 15%; white-space: nowrap; }
        .col-id { width: 10%; font-weight: bold; color: #d13212; }
        .col-name { width: 40%; font-weight: bold; }
        .col-loc { width: 20%; color: #666; font-size: 0.9em; }
        
        /* æ‰‹æ©ŸéŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 600px) {
            th, td { display: block; width: 100%; }
            tr.date-header { text-align: center; }
            .col-time { color: #d13212; font-weight: bold; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>AWS re:Invent 2025 å€‹äººè¡Œç¨‹è¡¨</h1>
    
    <div class="upload-box">
        <p>è«‹é¸æ“‡æ‚¨çš„ Excel (.xlsx) æˆ– CSV æª”æ¡ˆï¼š</p>
        <input type="file" id="fileInput" accept=".xlsx, .xls, .csv" />
    </div>

    <div id="status" style="color:red; margin-bottom:10px;"></div>

    <table id="scheduleTable">
        <thead>
            <tr>
                <th>æ™‚é–“</th>
                <th>ä»£è™Ÿ</th>
                <th>èª²ç¨‹åç¨±</th>
                <th>åœ°é»</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <tr><td colspan="4" style="text-align:center; color:#999;">è«‹ä¸Šå‚³æª”æ¡ˆä»¥æª¢è¦–è¡Œç¨‹...</td></tr>
        </tbody>
    </table>
</div>

<script>
    document.getElementById('fileInput').addEventListener('change', handleFile, false);

    function handleFile(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            
            // è®€å–ç¬¬ä¸€å€‹å·¥ä½œè¡¨
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            
            // è½‰æ›ç‚º JSON
            const jsonData = XLSX.utils.sheet_to_json(firstSheet);
            
            renderTable(jsonData);
        };
        reader.readAsArrayBuffer(file);
    }

    function renderTable(data) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        
        // 1. è³‡æ–™æ¸…æ´—èˆ‡å°æ‡‰ (Mapping)
        // æ ¹æ“šæ‚¨çš„ CSV æ¬„ä½åç¨±é€²è¡Œå°æ‡‰
        let sessions = data.map(row => {
            // å˜—è©¦æŠ“å–å¸¸è¦‹æ¬„ä½åç¨± (å®¹éŒ¯è™•ç†)
            return {
                Date: row['æ—¥æœŸ'] || row['Date'] || '',
                Time: row['æ™‚é–“'] || row['Time'] || '',
                ID: row['Session ID'] || row['Code'] || '',
                Name: row['èª²ç¨‹åç¨±'] || row['Title'] || '',
                Location: row['åœ°é»'] || row['Location'] || '',
                Selected: row['å·²é¸å–'] || '' // å¦‚æœæœ‰é€™å€‹æ¬„ä½ï¼Œå¯ä»¥ç”¨ä¾†éæ¿¾
            };
        }).filter(item => item.ID); // ç§»é™¤ç©ºè¡Œ

        // 2. æ’åº (å…ˆæŒ‰æ—¥æœŸï¼Œå†æŒ‰æ™‚é–“)
        sessions.sort((a, b) => {
            if (a.Date !== b.Date) return a.Date.localeCompare(b.Date);
            return a.Time.localeCompare(b.Time);
        });

        if (sessions.length === 0) {
            tbody.innerHTML = '<tr><td colspan="4">è®€å–ä¸åˆ°è³‡æ–™ï¼Œè«‹ç¢ºèª Excel æ¬„ä½åç¨±æ˜¯å¦æ­£ç¢º (éœ€åŒ…å«ï¼šæ—¥æœŸ, æ™‚é–“, Session ID, èª²ç¨‹åç¨±)</td></tr>';
            return;
        }

        // 3. æ¸²æŸ“è¡¨æ ¼
        let lastDate = '';

        sessions.forEach(item => {
            // æª¢æŸ¥æ˜¯å¦éœ€è¦æ’å…¥æ—¥æœŸæ¨™é¡Œåˆ—
            if (item.Date && item.Date !== lastDate) {
                const trDate = document.createElement('tr');
                trDate.className = 'date-header';
                trDate.innerHTML = `<td colspan="4">ğŸ“… ${item.Date}</td>`;
                tbody.appendChild(trDate);
                lastDate = item.Date;
            }

            // æ’å…¥èª²ç¨‹è³‡æ–™åˆ—
            const tr = document.createElement('tr');
            tr.className = 'session-row';
            tr.innerHTML = `
                <td class="col-time">${item.Time}</td>
                <td class="col-id">${item.ID}</td>
                <td class="col-name">${item.Name}</td>
                <td class="col-loc">${item.Location}</td>
            `;
            tbody.appendChild(tr);
        });
        
        document.getElementById('status').innerText = `å·²æˆåŠŸè¼‰å…¥ ${sessions.length} å€‹è­°ç¨‹`;
    }
</script>

</body>
</html>